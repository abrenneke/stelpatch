decision_unshackled_memorial {
    ai_weight = {
        weight = 1
    }

    sound = event_administrative_work
    owned_planets_only = yes
    enactment_time = 900
    resources = {
        category = decisions
        cost = {
            minerals = 2500
        }

    }

    potential = {
        owner = {
            has_country_flag = origin_broken_shackles_crashed_slaver_ship_depleted
        }

        has_deposit = d_crashed_slaver_ship
    }

    effect = {
        custom_tooltip = decision_unshackled_memorial_tt
        if = {
            hidden_effect = {
                remove_modifier = free_at_last_broken_shackles
                remove_modifier = culture_shock_broken_shackles
            }

            custom_tooltip = remove_broken_shackles_modifiers_tt
            limit = {
                has_modifier = free_at_last_broken_shackles
                has_modifier = culture_shock_broken_shackles
            }

        }

        if = {
            limit = {
                has_modifier = free_at_last_broken_shackles
                NOT = {
                    has_modifier = culture_shock_broken_shackles
                }

            }

            remove_modifier = free_at_last_broken_shackles
        }

        if = {
            limit = {
                NOT = {
                    has_modifier = free_at_last_broken_shackles
                }

                has_modifier = culture_shock_broken_shackles
            }

            remove_modifier = culture_shock_broken_shackles
        }

        hidden_effect = {
            replace_building_with_multiple_districts_effect = {
                BUILDING = building_low_tech_scrap_refinery
                NUM_BUILDINGS = 1
                NUM_DISTRICTS_2 = 2
                NUM_DISTRICTS_1 = 2
                DISTRICT_1 = district_mining
                DISTRICT_2 = district_industrial
            }

            remove_deposit = d_crashed_slaver_ship
            else = {
                replace_building_with_district_effect = {
                    BUILDING = building_low_tech_farm
                    NUM_BUILDINGS = 1
                    NUM_DISTRICTS = 3
                    DISTRICT = district_farming
                }

            }

            add_deposit = d_crashed_slaver_ship_memorial
            validate_and_repair_planet_buildings_and_districts = yes
            if = {
                replace_building_with_district_effect = {
                    BUILDING = building_low_tech_farm
                    NUM_BUILDINGS = 1
                    DISTRICT = district_farming_uncapped
                    NUM_DISTRICTS = 3
                }

                limit = {
                    is_planet_class = pc_ocean
                    owner = {
                        is_anglers_empire = yes
                    }

                }

            }

            while = {
                count = 2
                remove_district = district_city
            }

            replace_building_with_district_effect = {
                BUILDING = building_low_tech_power_plant
                NUM_DISTRICTS = 1
                NUM_BUILDINGS = 1
                DISTRICT = district_generator
            }

            swap_districts_effect = {
                DISTRICT1 = district_crashed_slaver_ship
                DISTRICT2 = district_city
            }

        }

    }

}

